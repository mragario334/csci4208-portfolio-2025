<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Zombie Survival - Phone Booth Ending</title>
<link rel="stylesheet" href="styles/style.css">
</head>
<body>
<header>
  <h1>ðŸ§Ÿ Zombie Survival</h1>
  <button id="restart-btn" class="small-red-btn">Restart</button>
  <table class="inventory-table">
    <tr><th>Coins</th><th>Keys</th><th>Weapon Cards</th></tr>
    <tr>
      <td id="coins">0</td>
      <td id="keys">0</td>
      <td id="weaponCards">0</td>
    </tr>
  </table>
</header>

<main class="scene active">
  <div class="intro-box" id="scene-text">
    <h2>Phone Booth</h2>
    <p id="description"></p>
    <div class="choices" id="choices-container"></div>
  </div>
</main>

<script>
// Restart button
document.getElementById('restart-btn').onclick = function() {
  localStorage.clear();
  location.href = "index.html";
};

if(!localStorage.getItem('coins')) localStorage.setItem('coins','0');
if(!localStorage.getItem('keys')) localStorage.setItem('keys','0');
if(!localStorage.getItem('weaponCards')) localStorage.setItem('weaponCards','0');

function typeWriter(element, text, speed=30, callback=null){
  let i = 0;
  element.textContent = "";
  const interval = setInterval(() => {
    element.textContent += text.charAt(i);
    i++;
    if(i >= text.length){
      clearInterval(interval);
      if(callback) callback();
    }
  }, speed);
}

window.onload = function(){
  const description = document.getElementById('description');
  const container = document.getElementById('choices-container');
  container.innerHTML = "";

  description.textContent = "You enter the phone booth. Thereâ€™s only one number left to callâ€¦";

  const callBtn = document.createElement('a');
  callBtn.href = "#";
  callBtn.className = "button";
  callBtn.textContent = "Call Dad";
  container.appendChild(callBtn);

  callBtn.onclick = function(e){
    e.preventDefault();
    container.innerHTML = ""; // remove button after click

    const dadMessage = "The line clicks. Your dadâ€™s voice, calm yet strained, comes through:\n\n" +
      "\"Sonâ€¦ I didnâ€™t want you to find out this way. The virusâ€¦ it was my project. I wanted to create a serum that could enhance human resilience, make people stronger and resistant to weakness. But the formula was unstable. Instead of strengthening, it amplified aggression and primal instincts. The 'resistant' humansâ€¦ became what you see now.\"\n\n" +
      "He pauses, voice heavy with regret: \"I thought I was helping humanity, but I created chaos. I never meant for this to happenâ€¦\"\n\n" +
      "The line goes dead. You stand in silence, the weight of the truth crashing down. The streets are quiet, but the world has changed forever.";

    typeWriter(description, dadMessage, 70, function(){
      const restartBtn = document.createElement('a');
      restartBtn.href = "index.html";
      restartBtn.className = "button";
      restartBtn.textContent = "The end...?";
      restartBtn.onclick = function(){ localStorage.clear(); };
      container.appendChild(restartBtn);
    });
  };
};
</script>
</body>
</html>
