<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Zombie Survival - Subway</title>
<link rel="stylesheet" href="styles/style.css">
</head>
<body>
<header>
    <h1>ðŸ§Ÿ Zombie Survival</h1>
    <button id="restart-btn" class="button">Restart Game</button>
    <table class="inventory-table">
      <tr><th>Coins</th><th>Keys</th><th>Weapon Cards</th></tr>
      <tr><td id="coins">0</td><td id="keys">0</td><td id="weaponCards">0</td></tr>
    </table>
</header>

<script>
// Restart button clears all progress
document.getElementById('restart-btn').onclick = function() {
  localStorage.clear();
  location.href = "index.html"; // go back to homepage
};
</script>

<main class="scene active">
<div class="intro-box">
  <h2>Subway</h2>
  <p id="description"></p>
  <div class="choices" id="choices-container"></div>
</div>
</main>

<script>
if (!localStorage.getItem('coins')) localStorage.setItem('coins','0');
if (!localStorage.getItem('keys')) localStorage.setItem('keys','0');
if (!localStorage.getItem('weaponCards')) localStorage.setItem('weaponCards','0');
if (!localStorage.getItem('weaponCard')) localStorage.setItem('weaponCard','false');

function updateInventoryDisplay() {
  document.getElementById('coins').textContent = localStorage.getItem('coins');
  document.getElementById('keys').textContent = localStorage.getItem('keys');
  document.getElementById('weaponCards').textContent = localStorage.getItem('weaponCards');
}

function gainItem(type, amount=1){
  let current=parseInt(localStorage.getItem(type));
  localStorage.setItem(type, current+amount);
  updateInventoryDisplay();
}

function addChoice(text, href, onClickFn=null){
  const container=document.getElementById('choices-container');
  const a=document.createElement('a');
  a.href=href;
  a.className="button";
  a.textContent=text;
  if(onClickFn) a.onclick=onClickFn;
  container.appendChild(a);
}

window.onload=function(){
  updateInventoryDisplay();
  const coins=parseInt(localStorage.getItem('coins'));
  const keys=parseInt(localStorage.getItem('keys'));
  const description=document.getElementById('description');

  description.textContent="You descend into the subway. Groans echo through the tunnels. You see a homeless guy. He looks drunk. He tells you he has a magical key, but he wants a coin for it.";

  // Only show the trade option if player has at least 1 coin and no keys yet
  if(coins >= 1 && keys === 0){
    addChoice("Trade 1 coin with the homeless guy for a key", "scene2.html", function(){
      localStorage.setItem('coins', coins - 1);
      localStorage.setItem('keys', keys + 1);
      updateInventoryDisplay();
    });
  }

  addChoice("Hide in a corner", "scene6.html");
  addChoice("Return to the streets", "scene2.html");
};
</script>
</body>
</html>
